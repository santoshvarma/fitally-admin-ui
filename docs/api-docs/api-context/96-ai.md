AI (Exercise Generation)
------------------------
POST /api/admin/ai/generate-exercises
Auth: Bearer token required (ADMIN or CONTENT_MANAGER)

Request:
```json
{
  "category": "GYM",
  "equipmentType": "DUMBBELL",
  "difficulty": "BEGINNER",
  "title": "Dumbbell Bent-Over Row",
  "count": 10
}
```

Response (async):
```json
{
  "jobId": "uuid",
  "message": "Exercise generation started in background"
}
```

Notes:
- Exercises are persisted to the `exercises` table.
- New exercises are saved as `active: false` and need admin approval.
- Duplicates are skipped by (title + category + equipmentType).
- Validation errors from AI output stop the batch; retries are attempted.
- AI can return `focusAreaMedia` to generate `MediaCategory.FOCUS_AREA`.

POST /api/admin/ai/generate-images/exercise/{exerciseId}
Auth: Bearer token required (ADMIN or CONTENT_MANAGER)

Response (async):
```json
{
  "jobId": "uuid",
  "message": "Exercise image generation started in background"
}
```

Notes:
- Generates images only for the selected exercise.
- Uses `metadata.imagePrompt` on existing Media records with `url` starting with `ai://`.
- Uploads images to Cloudinary and updates the Media `url` and metadata.
- Uses Gemini image endpoint (`gemini.image.model`, `gemini.image.url`).

POST /api/admin/ai/generate-image/media/{mediaId}
Auth: Bearer token required (ADMIN or CONTENT_MANAGER)

Request:
```json
{
  "imagePrompt": "Close-up of a dumbbell lunge showing the front knee alignment and hip hinge."
}
```

Response (async):
```json
{
  "jobId": "uuid",
  "message": "Media image generation started in background"
}
```

GET /api/admin/ai/jobs/{jobId}
Response:
```json
{
  "id": "uuid",
  "type": "EXERCISE_IMAGE_GENERATION",
  "total": 10,
  "completed": 4,
  "state": "RUNNING",
  "message": "image generated",
  "updatedAt": "2026-02-08T12:00:00Z"
}
```

GET /api/admin/ai/jobs/{jobId}/events
Response:
```
event: status
data: {"id":"uuid","type":"EXERCISE_IMAGE_GENERATION","total":10,"completed":4,"state":"RUNNING","message":"image generated","updatedAt":"2026-02-08T12:00:00Z"}
```

Notes:
- SSE clients that cannot send headers can pass `access_token` as a query param.
  Example: `/api/admin/ai/jobs/{jobId}/events?access_token=JWT`

Job types:
- EXERCISE_GENERATION
- EXERCISE_IMAGE_GENERATION
- MEDIA_IMAGE_GENERATION

Job states:
- PENDING
- RUNNING
- COMPLETED
- COMPLETED_WITH_ERRORS
- FAILED

Notes:
- Regenerates image for a single Media record.
- If `imagePrompt` is provided, it overrides `metadata.imagePrompt` for this generation.
